<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <record id="l10n_ec_barter_product_template_form" model="ir.ui.view">
        <field name="name">l10n_ec_barter_product_template_form</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="mode">primary</field>
        <field name="priority">24</field>
        <field name="arch" type="xml">
            <xpath expr="//header" position="replace">
                <header>
                    <field name="l10n_ec_state" widget="statusbar"/>
                    <button string="Publicar" type="object" name="action_published"/>
                    <button string="Descartar" type="object" name="action_discarded"/>
                    <button string="Regresar a Borrador" type="object" name="action_not_published"/>
                </header>
            </xpath>
        </field>
    </record>

    <record id="l10n_ec_barter_product_template_kanban" model="ir.ui.view">
        <field name="name">l10n_ec_barter_product_template_kanban</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_kanban_view"/>
        <field name="mode">primary</field>
        <field name="priority">24</field>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='id']" position="after">
                <field name="name"/>
            </xpath>
        </field>
    </record>

    <record id="l10n_ec_barter_product_template_search" model="ir.ui.view">
        <field name="name">l10n_ec_barter_product_template_search</field>
        <field name="model">product.template</field>
        <field name="arch" type="xml">
            <search>
                <filter string="Mis productos" name="my_products"
                        domain="[('l10n_ec_user_id', '=', uid)]"/>
            </search>
        </field>
    </record>

    <record id="l10n_ec_barter_my_product_template_action" model="ir.actions.act_window">
        <field name="name">Mis Productos</field>
        <field name="res_model">product.template</field>
        <field name="search_view_id" ref="l10n_ec_barter_product_template_search"/>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('l10n_ec_barter_product_template_kanban')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('l10n_ec_barter_product_template_form')})]"/>
        <field name="view_mode">kanban,form</field>
        <field name="domain">[('l10n_ec_user_id','=', uid)]</field>
        <field name="context">{
            'search_default_my_products': 1,
            }
        </field>
    </record>

    <record id="l10n_ec_barter_product_template_action" model="ir.actions.act_window">
        <field name="name">Productos</field>
        <field name="res_model">product.template</field>
        <field name="domain">[('l10n_ec_state','=', 'published')]</field>
        <field name="search_view_id" ref="l10n_ec_barter_product_template_search"/>
        <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'kanban', 'view_id': ref('l10n_ec_barter_product_template_kanban')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('l10n_ec_barter_product_template_form')})]"/>
        <field name="view_mode">kanban,form</field>
    </record>

    <menuitem
            id="l10n_ec_barter_my_product_template_menu"
            action="l10n_ec_barter_my_product_template_action"
            name="Mis Productos"
            groups="client_barter_group,admin_barter_group"
            parent="l10n_ec_barter_menu"
            sequence="2"/>
    <menuitem
            id="l10n_ec_barter_product_template_menu"
            action="l10n_ec_barter_product_template_action"
            name="Productos"
            groups="client_barter_group,admin_barter_group"
            parent="l10n_ec_barter_menu"
            sequence="3"/>
</odoo>